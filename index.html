<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoice Creator</title>
    <link rel="stylesheet" href="style.css">
    <!-- EmailJS for sending real emails -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
</head>

<body>
    <div class="app-container">
        <!-- Invoice Paper -->
        <div class="invoice-paper" id="invoicePaper">

            <!-- Top Section: Company Left, Invoice Info Right -->
            <div class="invoice-top">
                <!-- Left: Logo + Business Info -->
                <div class="left-section">
                    <div class="logo-box" id="logoBox">
                        <input type="file" id="logoInput" accept="image/*" hidden>
                        <div class="logo-placeholder" id="logoPlaceholder">
                            <span>+ Add a logo</span>
                        </div>
                        <img id="logoImage" src="" alt="Logo" style="display:none;">
                    </div>
                    <input type="text" id="businessName" class="business-name" placeholder="Business Name">
                    <textarea id="businessAddress" class="business-address" placeholder="Business Address"
                        rows="2"></textarea>
                </div>

                <!-- Right: Invoice Details -->
                <div class="right-section">
                    <div class="info-row">
                        <label>Date:</label>
                        <input type="date" id="invoiceDate">
                    </div>
                    <div class="info-row">
                        <label>Invoice Number:</label>
                        <input type="text" id="invoiceNumber" value="10000">
                    </div>
                    <div class="info-row">
                        <label>Payment Terms:</label>
                        <select id="paymentTerms">
                            <option value="pay-in-days">Pay in Days</option>
                            <option value="due-on-receipt">Due on Receipt</option>
                            <option value="net-15">Net 15</option>
                            <option value="net-30">Net 30</option>
                        </select>
                        <input type="number" id="paymentDays" class="days-input" value="30" min="0">
                    </div>
                    <div class="info-row">
                        <label>Purchase Order #:</label>
                        <input type="text" id="purchaseOrder" placeholder="Optional">
                    </div>
                    <div class="info-row">
                        <label>Salesperson:</label>
                        <input type="text" id="salesperson" placeholder="Optional">
                    </div>
                    <div class="info-row">
                        <label>Shipping Address:</label>
                        <input type="text" id="shippingAddress" placeholder="Leave blank if same as Billing Address">
                    </div>
                    <a href="#" class="add-fields-link" id="addFieldsLink">+ Add Other Invoice Fields</a>
                    <!-- Extra Fields (Hidden by default) -->
                    <div class="extra-fields" id="extraFields" style="display:none;">
                        <div class="info-row">
                            <label>Tax ID:</label>
                            <input type="text" id="taxId" placeholder="Optional">
                        </div>
                        <div class="info-row">
                            <label>Project:</label>
                            <input type="text" id="project" placeholder="Optional">
                        </div>
                        <div class="info-row">
                            <label>Currency:</label>
                            <select id="currency">
                                <option value="RM">RM (MYR)</option>
                                <option value="$">$ (USD)</option>
                                <option value="â‚¬">â‚¬ (EUR)</option>
                                <option value="Â£">Â£ (GBP)</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Customer Section -->
            <div class="customer-section">
                <div class="customer-row">
                    <label>Customer:</label>
                    <select id="customerSelect">
                        <option value=""></option>
                    </select>
                </div>
                <div class="billing-row">
                    <label>Billing Address:</label>
                    <textarea id="billingAddress" rows="2"></textarea>
                </div>
            </div>

            <!-- Items Table -->
            <div class="items-section">
                <table class="items-table" id="itemsTable">
                    <thead>
                        <tr>
                            <th class="col-qty">
                                <select class="header-select">
                                    <option>Qty</option>
                                    <option>Hours</option>
                                </select>
                            </th>
                            <th class="col-code">
                                <select class="header-select">
                                    <option>Item Code</option>
                                    <option>SKU</option>
                                </select>
                            </th>
                            <th class="col-desc">
                                <select class="header-select">
                                    <option>Description</option>
                                    <option>Service</option>
                                </select>
                            </th>
                            <th class="col-price">
                                <select class="header-select">
                                    <option>Unit Price</option>
                                    <option>Rate</option>
                                </select>
                            </th>
                            <th class="col-tax">
                                <select class="header-select">
                                    <option>Tax</option>
                                    <option>VAT</option>
                                </select>
                            </th>
                            <th class="col-total">
                                <select class="header-select">
                                    <option>Total</option>
                                    <option>Amount</option>
                                </select>
                            </th>
                            <th class="col-action"></th>
                        </tr>
                    </thead>
                    <tbody id="itemsBody">
                        <!-- Items will be added here -->
                    </tbody>
                </table>

                <!-- Item Buttons -->
                <div class="item-buttons">
                    <button id="addItemBtn" class="btn btn-add-item">+ Add Item</button>
                    <button id="addDiscountBtn" class="btn btn-add-discount">+ Add Discount</button>
                    <button id="addShippingBtn" class="btn btn-add-shipping">+ Add Shipping</button>
                </div>
            </div>

            <!-- Notes and Totals Row -->
            <div class="notes-totals-row">
                <!-- Notes Section -->
                <div class="notes-section">
                    <div class="notes-tabs">
                        <button class="tab active" data-tab="public">Public Note</button>
                        <button class="tab" data-tab="private">Private Note</button>
                        <button class="tab" data-tab="foot">Foot Note</button>
                    </div>
                    <div class="notes-content">
                        <textarea id="publicNote" class="note-textarea active" placeholder=""></textarea>
                        <textarea id="privateNote" class="note-textarea" style="display:none;"></textarea>
                        <textarea id="footNote" class="note-textarea" style="display:none;"></textarea>
                    </div>
                </div>

                <!-- Totals Section -->
                <div class="totals-section">
                    <div class="total-row">
                        <span class="label">Subtotal:</span>
                        <span class="value" id="subtotalDisplay">RM0.00</span>
                    </div>
                    <div class="total-row total-final">
                        <span class="label">Total:</span>
                        <span class="value" id="totalDisplay">RM0.00</span>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
                <div class="left-buttons">
                    <button id="feedbackBtn" class="btn btn-feedback">âœ‰ Send Feedback</button>
                </div>
                <div class="right-buttons">
                    <button id="clearBtn" class="btn btn-secondary">Clear Invoice</button>
                    <button id="previewBtn" class="btn btn-secondary">Preview Invoice</button>
                    <div class="save-dropdown" id="saveDropdown">
                        <button id="saveBtn" class="btn btn-primary">Save and Download</button>
                        <button class="btn btn-primary dropdown-arrow" id="saveDropdownBtn">â–¼</button>
                        <div class="save-dropdown-menu" id="saveDropdownMenu">
                            <a href="#" data-action="create">Create Invoice</a>
                            <a href="#" data-action="email">Create and Email</a>
                            <a href="#" data-action="print">Create and Print</a>
                            <a href="#" data-action="recurring">Create as Recurring</a>
                            <a href="#" data-action="draft">Create as Draft</a>
                            <a href="#" data-action="preview">Create and Preview</a>
                            <a href="#" data-action="payment">Create and Apply Payment</a>
                            <a href="#" data-action="download">Save and Download</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Preview Modal -->
    <div class="modal-overlay" id="previewModal" style="display:none;">
        <div class="modal-container">
            <div class="modal-header">
                <h3>Invoice Preview</h3>
                <button class="modal-close" id="closePreview">&times;</button>
            </div>
            <div class="modal-body" id="previewContent">
                <!-- Preview content will be injected here -->
            </div>
            <div class="modal-footer">
                <button id="printBtn" class="btn btn-primary">ðŸ“¥ Save as PDF</button>
            </div>
        </div>
    </div>

    <!-- Discount Modal (Apply Discount) -->
    <div class="modal-overlay" id="discountModal" style="display:none;">
        <div class="modal-container modal-medium" style="max-width: 450px;">
            <div class="modal-header">
                <h3>Apply Discount</h3>
                <button class="modal-close" id="closeDiscount">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Fixed flat discount -->
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="radio" name="discountType" value="flat" checked>
                        Fixed flat discount to the whole invoice
                    </label>
                    <div style="display: flex; align-items: center; gap: 20px; margin-top: 8px; margin-left: 25px;">
                        <span style="color: #999;">Discount Amount:</span>
                        <input type="number" id="flatDiscount" value="10.00" min="0" step="0.01"
                            style="width: 100px; padding: 8px; border: 1px solid #ccc; text-align: right;">
                    </div>
                </div>

                <!-- Fixed percentage discount -->
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="radio" name="discountType" value="percent">
                        Fixed percentage discount to the whole invoice
                    </label>
                    <div style="display: flex; align-items: center; gap: 20px; margin-top: 8px; margin-left: 25px;">
                        <span style="color: #999;">Discount Percent:</span>
                        <input type="text" id="percentDiscount" value="0%"
                            style="width: 100px; padding: 8px; border: 1px solid #ccc; text-align: right;">
                    </div>
                </div>

                <!-- Line-by-line discount -->
                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="radio" name="discountType" value="line">
                        Apply line-by-line discounts to specific items
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button id="applyDiscount" class="btn btn-primary" style="background: #449d44;">Apply</button>
                <button id="cancelDiscount" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Email Modal -->
    <div class="modal-overlay" id="emailModal" style="display:none;">
        <div class="modal-container modal-small">
            <div class="modal-header">
                <h3>Send Invoice by Email</h3>
                <button class="modal-close" id="closeEmail">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Recipient Email:</label>
                    <input type="email" id="recipientEmail" placeholder="customer@example.com"
                        style="width: 100%; padding: 8px; margin-top: 5px;">
                </div>
                <div class="form-group" style="margin-top: 10px;">
                    <label>Your Email:</label>
                    <input type="email" id="senderEmail" placeholder="your@email.com"
                        style="width: 100%; padding: 8px; margin-top: 5px;">
                </div>
                <div class="form-group" style="margin-top: 10px;">
                    <label>Message (optional):</label>
                    <textarea id="emailMessage" rows="3" placeholder="Additional message..."
                        style="width: 100%; padding: 8px; margin-top: 5px;"></textarea>
                </div>
                <div id="emailStatus" style="margin-top: 10px; font-size: 12px;"></div>
            </div>
            <div class="modal-footer">
                <button id="cancelEmail" class="btn btn-secondary">Cancel</button>
                <button id="sendEmail" class="btn btn-primary">ðŸ“§ Send Email</button>
            </div>
        </div>
    </div>

    <!-- New Item Modal -->
    <div class="modal-overlay" id="newItemModal" style="display:none;">
        <div class="modal-container modal-medium">
            <div class="modal-header">
                <h3>New Item</h3>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <a href="#" style="font-size: 12px;">Help</a>
                    <button class="modal-close" id="closeNewItem">&times;</button>
                </div>
            </div>
            <div class="modal-body" style="max-height: 500px; overflow-y: auto;">
                <div class="form-group">
                    <label>Item Code:</label>
                    <input type="text" id="newItemCode"
                        style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc;">
                </div>
                <div class="form-group" style="margin-top: 10px;">
                    <label>Description:</label>
                    <textarea id="newItemDescription" rows="4"
                        style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc;"></textarea>
                </div>
                <div class="form-group" style="margin-top: 10px;">
                    <label>Unit Value:</label>
                    <input type="text" id="newItemUnitValue" value="RM0.00"
                        style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc;">
                </div>
                <div class="form-group" style="margin-top: 10px;">
                    <label>Tax:</label>
                    <select id="newItemTax" style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc;">
                        <option value="0">[None]</option>
                        <option value="6">SST 6%</option>
                        <option value="10">Tax 10%</option>
                    </select>
                </div>
                <div class="form-group" style="margin-top: 15px;">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="manageInventory">
                        Manage the inventory stock levels
                    </label>
                </div>
                <div class="form-group" style="margin-top: 10px;">
                    <label>Current Quantity:</label>
                    <input type="number" id="currentQuantity"
                        style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; background: #f5f5f5;">
                </div>
                <div class="form-group" style="margin-top: 10px;">
                    <label>Ideal Quantity:</label>
                    <input type="number" id="idealQuantity"
                        style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; background: #f5f5f5;">
                </div>
                <div class="form-group" style="margin-top: 10px;">
                    <label>Warning Quantity:</label>
                    <input type="number" id="warningQuantity"
                        style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; background: #f5f5f5;">
                </div>
                <div class="form-group" style="margin-top: 10px;">
                    <label>Supplier:</label>
                    <select id="newItemSupplier"
                        style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc;">
                        <option value="">Select Supplier</option>
                    </select>
                </div>
                <div class="form-group" style="margin-top: 10px;">
                    <label>Note:</label>
                    <textarea id="newItemNote" rows="2"
                        style="width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc;"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button id="createNewItem" class="btn btn-primary" style="background: #449d44;">Create Item</button>
                <button id="cancelNewItem" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- New Tax Modal -->
    <div class="modal-overlay" id="newTaxModal" style="display:none;">
        <div class="modal-container modal-medium">
            <div class="modal-header">
                <h3>New Tax</h3>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <a href="#" style="font-size: 12px;">Help</a>
                    <button class="modal-close" id="closeNewTax">&times;</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="form-group" style="display: flex; align-items: center; gap: 20px;">
                    <label style="min-width: 120px;">Tax Name:</label>
                    <input type="text" id="newTaxName" style="flex: 1; padding: 8px; border: 1px solid #ccc;">
                </div>
                <div class="form-group" style="margin-top: 15px; display: flex; align-items: center; gap: 20px;">
                    <label style="min-width: 120px; display: flex; align-items: center; gap: 5px;">
                        <input type="radio" name="taxType" value="simple" checked id="taxTypeSimple">
                        Tax Rate(%):
                    </label>
                    <input type="number" id="newTaxRate" step="0.01"
                        style="flex: 1; padding: 8px; border: 1px solid #ccc;">
                </div>
                <div class="form-group" style="margin-top: 10px;">
                    <label style="display: flex; align-items: center; gap: 5px;">
                        <input type="radio" name="taxType" value="combined" id="taxTypeCombined">
                        Combined Tax Rate:
                    </label>
                </div>
                <div class="form-group" style="margin-top: 10px; display: flex; align-items: center; gap: 20px;">
                    <label style="min-width: 120px;">Tax Rate 1:</label>
                    <select id="taxRate1" style="flex: 1; padding: 8px; border: 1px solid #ccc;">
                        <option value="">[None]</option>
                    </select>
                </div>
                <div class="form-group" style="margin-top: 10px; display: flex; align-items: center; gap: 20px;">
                    <label style="min-width: 120px;">Tax Rate 2:</label>
                    <select id="taxRate2" style="flex: 1; padding: 8px; border: 1px solid #ccc;">
                        <option value="">[None]</option>
                    </select>
                </div>
                <div class="form-group" style="margin-top: 15px;">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="taxCompounding">
                        Compounding (Rate 2 is applied after Rate 1)
                    </label>
                </div>
                <div class="form-group" style="margin-top: 10px;">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="taxDefault">
                        Use this as my default tax rate
                    </label>
                </div>
                <div class="form-group" style="margin-top: 10px;">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="taxShowZero">
                        Show zero percent
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveTax" class="btn btn-primary" style="background: #449d44;">Save Tax</button>
                <button id="cancelNewTax" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- New Customer Modal -->
    <div class="modal-overlay" id="newCustomerModal" style="display:none;">
        <div class="modal-container modal-large">
            <div class="modal-header">
                <h3>New Customer</h3>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <a href="#" style="font-size: 12px;">Help</a>
                    <button class="modal-close" id="closeNewCustomer">&times;</button>
                </div>
            </div>
            <div class="modal-body" style="max-height: 500px; overflow-y: auto;">
                <!-- Row 1: Customer Name, Email, Telephone -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                    <div class="form-group">
                        <label>Customer Name:</label>
                        <input type="text" id="newCustomerName" placeholder="Enter customer name"
                            style="width: 100%; padding: 8px; border: 1px solid #ccc;">
                    </div>
                    <div class="form-group">
                        <label>Email:</label>
                        <input type="email" id="newCustomerEmail" placeholder="jane.doe@acme.com"
                            style="width: 100%; padding: 8px; border: 1px solid #ccc;">
                    </div>
                    <div class="form-group">
                        <label>Telephone:</label>
                        <input type="text" id="newCustomerTelephone" placeholder="555 123 4567"
                            style="width: 100%; padding: 8px; border: 1px solid #ccc;">
                    </div>
                </div>

                <!-- Row 2: Contact person, Salesperson, Group -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-top: 15px;">
                    <div class="form-group">
                        <label>Contact person (optional):</label>
                        <input type="text" id="newCustomerContact" placeholder="Enter the contact name"
                            style="width: 100%; padding: 8px; border: 1px solid #ccc;">
                    </div>
                    <div class="form-group">
                        <label>Salesperson:</label>
                        <select id="newCustomerSalesperson" style="width: 100%; padding: 8px; border: 1px solid #ccc;">
                            <option value="">Optional</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Group:</label>
                        <select id="newCustomerGroup" style="width: 100%; padding: 8px; border: 1px solid #ccc;">
                            <option value="">Select Group</option>
                        </select>
                    </div>
                </div>

                <!-- Row 3: Billing Address, Shipping Address, Active checkbox -->
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-top: 15px;">
                    <div class="form-group">
                        <label>Billing Address:</label>
                        <textarea id="newCustomerBillingAddress" rows="3" placeholder="Enter address"
                            style="width: 100%; padding: 8px; border: 1px solid #ccc;"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Shipping Address:</label>
                        <textarea id="newCustomerShippingAddress" rows="3"
                            placeholder="Leave blank to use Billing Address"
                            style="width: 100%; padding: 8px; border: 1px solid #ccc;"></textarea>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 8px; margin-top: 20px;">
                            <input type="checkbox" id="customerActive" checked>
                            This customer is active
                        </label>
                    </div>
                </div>

                <!-- Row 4: Notes and Right side info -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                    <div>
                        <!-- Notes tabs -->
                        <div style="display: flex; gap: 0;">
                            <button type="button" class="customer-note-tab active" data-tab="private"
                                style="padding: 8px 15px; border: 1px solid #ccc; background: white; cursor: pointer;">Private
                                Note</button>
                            <button type="button" class="customer-note-tab" data-tab="statement"
                                style="padding: 8px 15px; border: 1px solid #ccc; background: #f5f5f5; cursor: pointer;">Statement
                                Foot Note</button>
                        </div>
                        <textarea id="customerPrivateNote" rows="3" placeholder="Note for internal use only"
                            style="width: 100%; padding: 8px; border: 1px solid #ccc; margin-top: -1px;"></textarea>
                        <textarea id="customerStatementNote" rows="3"
                            placeholder="This note is not visible on the Statement"
                            style="width: 100%; padding: 8px; border: 1px solid #ccc; display: none;"></textarea>
                    </div>
                    <div>
                        <div class="form-group">
                            <label>Additional Printed Info:</label>
                            <input type="text" id="customerAdditionalInfo" placeholder="ABN: 66 012 345 678"
                                style="width: 100%; padding: 8px; border: 1px solid #ccc;">
                        </div>
                        <div class="form-group" style="margin-top: 10px;">
                            <label>Payment Terms:</label>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <select id="customerPaymentType" style="padding: 8px; border: 1px solid #ccc;">
                                    <option value="days">Pay in Days</option>
                                    <option value="end">End of Month</option>
                                </select>
                                <input type="number" id="customerPaymentDays" value="30"
                                    style="width: 60px; padding: 8px; border: 1px solid #ccc;">
                            </div>
                        </div>
                        <div class="form-group" style="margin-top: 10px;">
                            <label>Method:</label>
                            <select id="customerMethod" style="width: 100%; padding: 8px; border: 1px solid #ccc;">
                                <option value="cash">Cash</option>
                                <option value="bank">Bank Transfer</option>
                                <option value="card">Credit Card</option>
                                <option value="cheque">Cheque</option>
                            </select>
                        </div>
                        <div class="form-group" style="margin-top: 10px;">
                            <label style="display: flex; align-items: center; gap: 8px;">
                                <input type="checkbox" id="customerTaxExempt">
                                Set tax exempt for this customer
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveCustomer" class="btn btn-primary" style="background: #449d44;">Save Customer</button>
                <button id="cancelNewCustomer" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Recurring Invoice Schedule Modal -->
    <div class="modal-overlay" id="recurringModal" style="display:none;">
        <div class="modal-container modal-medium" style="max-width: 480px;">
            <div class="modal-header">
                <h3>Recurring Invoice Schedule</h3>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <a href="#" style="font-size: 12px;">Help</a>
                    <button class="modal-close" id="closeRecurring">&times;</button>
                </div>
            </div>
            <div class="modal-body">
                <div class="form-group" style="display: flex; align-items: center; gap: 20px; margin-bottom: 15px;">
                    <label style="min-width: 80px;">Start Date:</label>
                    <input type="date" id="recurringStartDate" style="padding: 8px; border: 1px solid #ccc;">
                </div>
                <div class="form-group" style="display: flex; align-items: center; gap: 20px; margin-bottom: 15px;">
                    <label style="min-width: 80px;">Interval:</label>
                    <select id="recurringInterval" style="width: 150px; padding: 8px; border: 1px solid #ccc;">
                        <option value="1">Monthly</option>
                        <option value="3">3 Monthly</option>
                        <option value="6" selected>6 Monthly</option>
                        <option value="12">Yearly</option>
                    </select>
                </div>
                <div class="form-group" style="display: flex; align-items: center; gap: 20px; margin-bottom: 20px;">
                    <label style="min-width: 80px;">Action:</label>
                    <select id="recurringAction" style="width: 150px; padding: 8px; border: 1px solid #ccc;">
                        <option value="record">Just record</option>
                        <option value="email">Email customer</option>
                        <option value="print">Print invoice</option>
                    </select>
                </div>
                <div class="form-group" style="margin-bottom: 10px;">
                    <label style="display: flex; align-items: flex-start; gap: 8px;">
                        <input type="checkbox" id="updatePrices" style="margin-top: 3px;">
                        Update the prices of any items which have been changed
                    </label>
                </div>
                <div class="form-group">
                    <label style="display: flex; align-items: flex-start; gap: 8px;">
                        <input type="checkbox" id="replacePeriod" style="margin-top: 3px;">
                        Replace the string %period% in any descriptions with dates
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button id="recordRecurring" class="btn btn-primary" style="background: #449d44;">Record</button>
                <button id="cancelRecurring" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Invoice Field Names Modal -->
    <div class="modal-overlay" id="fieldNamesModal" style="display:none;">
        <div class="modal-container modal-medium" style="max-width: 480px;">
            <div class="modal-header">
                <h3>Invoice Field Names</h3>
                <button class="modal-close" id="closeFieldNames">&times;</button>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 15px; font-size: 14px; color: #333; line-height: 1.5;">
                    Invoice labels can be changed in Invoice Text Settings. For example, [Purchase Order #] could be
                    changed to [Job #] or [Work #] to meet your business needs.
                </p>
                <p style="margin-bottom: 20px; font-size: 14px; color: #333;">
                    Custom Fields can be added in Invoice Settings.
                </p>
            </div>
            <div class="modal-footer" style="flex-wrap: wrap; gap: 10px;">
                <button id="invoiceTextSettings" class="btn btn-primary" style="background: #449d44;">Invoice Text
                    Settings</button>
                <button id="invoiceSettings" class="btn btn-primary" style="background: #449d44;">Invoice
                    Settings</button>
                <button id="continueCreating" class="btn btn-primary" style="background: #449d44;">Continue Creating
                    Invoice</button>
            </div>
        </div>
    </div>

    <!-- Apply Payment Modal -->
    <div class="modal-overlay" id="paymentModal" style="display:none;">
        <div class="modal-container modal-medium" style="max-width: 420px;">
            <div class="modal-header">
                <h3>Apply Payment</h3>
                <button class="modal-close" id="closePayment">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group" style="display: flex; align-items: center; gap: 20px; margin-bottom: 15px;">
                    <label style="min-width: 120px;">Payment Amount:</label>
                    <input type="text" id="paymentAmount" value="RM0.00"
                        style="flex: 1; padding: 8px; border: 1px solid #ccc;">
                </div>
                <div class="form-group" style="display: flex; align-items: center; gap: 20px; margin-bottom: 15px;">
                    <label style="min-width: 120px;">Method:</label>
                    <select id="paymentMethod" style="flex: 1; padding: 8px; border: 1px solid #ccc;">
                        <option value="cash">Cash</option>
                        <option value="bank">Bank Transfer</option>
                        <option value="card">Credit Card</option>
                        <option value="cheque">Cheque</option>
                    </select>
                </div>
                <div class="form-group" style="display: flex; align-items: center; gap: 20px;">
                    <label style="min-width: 120px;">Reference Number:</label>
                    <input type="text" id="paymentReference" style="flex: 1; padding: 8px; border: 1px solid #ccc;">
                </div>
            </div>
            <div class="modal-footer">
                <button id="applyPaymentBtn" class="btn btn-primary" style="background: #449d44;">Apply Payment</button>
                <button id="cancelPayment" class="btn btn-secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Invoice Text Settings Modal -->
    <div class="modal-overlay" id="textSettingsModal" style="display:none;">
        <div class="modal-container modal-large" style="max-width: 600px; max-height: 90vh; overflow: auto;">
            <div class="modal-header">
                <h3 style="font-size: 1.5rem; font-weight: normal; color: #333;">Invoice Text Settings</h3>
                <button class="modal-close" id="closeTextSettings">&times;</button>
            </div>
            <div class="modal-body" style="padding: 0;">
                <!-- Tabs -->
                <div style="display: flex; border-bottom: 1px solid #ccc;">
                    <button class="settings-tab active" data-tab="text"
                        style="padding: 10px 20px; border: 1px solid #ccc; border-bottom: none; background: white; cursor: pointer;">Text</button>
                    <button class="settings-tab" data-tab="attributes"
                        style="padding: 10px 20px; border: 1px solid #ccc; border-bottom: none; background: #f5f5f5; cursor: pointer;">Text
                        Attributes</button>
                </div>

                <!-- Text Tab Content -->
                <div id="textTabContent" style="padding: 15px;">
                    <p style="color: #c00; font-size: 12px; margin-bottom: 15px;">In order to change the desired heading
                        just click on the right column text.</p>

                    <div class="settings-row"><label>Invoice Title:</label><input type="text" id="txtInvoiceTitle"
                            value="Invoice"></div>
                    <div class="settings-row"><label>Invoice Date Title:</label><input type="text" id="txtDateTitle"
                            value="Date"></div>
                    <div class="settings-row"><label>Invoice Number Title:</label><input type="text" id="txtNumberTitle"
                            value="Invoice No."></div>
                    <div class="settings-row"><label>Due Date Title:</label><input type="text" id="txtDueDateTitle"
                            value="Due Date"></div>
                    <div class="settings-row"><label>Purchase Order Title:</label><input type="text" id="txtPOTitle"
                            value="P.O. #"></div>
                    <div class="settings-row"><label>Billing Address Title:</label><input type="text"
                            id="txtBillingTitle" value="Bill To"></div>
                    <div class="settings-row"><label>Shipping Address Title:</label><input type="text"
                            id="txtShippingTitle" value="Ship To"></div>
                    <div class="settings-row"><label>Salesperson Title:</label><input type="text"
                            id="txtSalespersonTitle" value="Salesperson"></div>
                    <div class="settings-row"><label>Quantity Column Title:</label><input type="text" id="txtQtyTitle"
                            value="Qty"></div>
                    <div class="settings-row"><label>Item Code Title:</label><input type="text" id="txtItemCodeTitle"
                            value="Item Code"></div>
                    <div class="settings-row"><label>Description Title:</label><input type="text" id="txtDescTitle"
                            value="Description"></div>
                    <div class="settings-row"><label>Unit Price Column Title:</label><input type="text"
                            id="txtUnitPriceTitle" value="Unit Price"></div>
                    <div class="settings-row"><label>Discount Column Title:</label><input type="text"
                            id="txtDiscountColTitle" value="Discount"></div>
                    <div class="settings-row"><label>Sales Tax Column Title:</label><input type="text"
                            id="txtTaxColTitle" value="Tax"></div>
                    <div class="settings-row"><label>Total Column Title:</label><input type="text" id="txtTotalColTitle"
                            value="Total"></div>
                    <div class="settings-row"><label>Shipping Costs Title:</label><input type="text"
                            id="txtShippingCostTitle" value="Shipping"></div>
                    <div class="settings-row"><label>Subtotal Title:</label><input type="text" id="txtSubtotalTitle"
                            value="Subtotal"></div>
                    <div class="settings-row"><label>Discount Title:</label><input type="text" id="txtDiscountTitle"
                            value="Discount"></div>
                    <div class="settings-row"><label>Total Title:</label><input type="text" id="txtTotalTitle"
                            value="Total"></div>
                    <div class="settings-row"><label>Paid Title:</label><input type="text" id="txtPaidTitle"
                            value="Paid"></div>
                    <div class="settings-row"><label>Balance Title:</label><input type="text" id="txtBalanceTitle"
                            value="Balance"></div>
                    <div class="settings-row"><label>Public Note Header:</label><input type="text"
                            id="txtPublicNoteHeader" placeholder="Enter Public Note Header"></div>
                    <div class="settings-row"><label>Foot Note Header:</label><input type="text" id="txtFootNoteHeader"
                            placeholder="Enter Foot Note Header"></div>
                </div>

                <!-- Text Attributes Tab Content -->
                <div id="attributesTabContent" style="padding: 15px; display: none;">
                    <div style="margin-bottom: 15px;">
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="radio" name="textAttrType" value="global">
                            Use global text attributes
                        </label>
                        <button class="btn btn-secondary" style="margin-left: 25px; margin-top: 5px;">Global
                            Attributes...</button>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="radio" name="textAttrType" value="section" checked>
                            Set text attribute for each section
                        </label>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-left: 25px;">
                        <button class="btn btn-secondary">Invoice Title...</button>
                        <button class="btn btn-secondary">Company Name...</button>
                        <button class="btn btn-secondary">Heading Text...</button>
                        <button class="btn btn-secondary">Table Heading Text...</button>
                        <button class="btn btn-secondary">All Other Text...</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveTextSettings" class="btn btn-primary" style="background: #449d44;">Save
                    Settings</button>
            </div>
        </div>
    </div>

    <!-- Invoice Settings Modal -->
    <div class="modal-overlay" id="invoiceSettingsModal" style="display:none;">
        <div class="modal-container modal-large" style="max-width: 700px; max-height: 90vh; overflow: auto;">
            <div class="modal-header" style="position: sticky; top: 0; background: white; z-index: 10;">
                <h3 style="font-size: 1.5rem; font-weight: normal; color: #333;">Invoice Settings</h3>
                <div>
                    <button id="saveInvoiceSettingsTop" class="btn btn-primary" style="background: #449d44;">Save
                        Settings</button>
                    <button class="modal-close" id="closeInvoiceSettings">&times;</button>
                </div>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <!-- Invoice, Credit Note, and Quote Options -->
                <h4 style="color: #333; border-bottom: 1px solid #ccc; padding-bottom: 5px; margin-bottom: 10px;">
                    Invoice, Credit Note, and Quote Options</h4>
                <div class="checkbox-group">
                    <label><input type="checkbox" id="setShowItemCode"> Show Item Code column</label>
                    <label><input type="checkbox" id="setShowDiscount"> Show Discount column</label>
                    <label><input type="checkbox" id="setPrintSalesperson"> Print salesperson name</label>
                    <label><input type="checkbox" id="setHideBillShip"> Hide Bill To and Ship To labels</label>
                    <label><input type="checkbox" id="setReplaceText"> Replace %TEXT% in comments (see Help)</label>
                    <label><input type="checkbox" id="setAlwaysShipping" checked> Always display shipping
                        address</label>
                </div>

                <!-- Invoice Options -->
                <h4 style="color: #333; border-bottom: 1px solid #ccc; padding-bottom: 5px; margin: 20px 0 10px;">
                    Invoice Options</h4>
                <div class="checkbox-group">
                    <label><input type="checkbox" id="setPrintDueDate" checked> Print Due Date</label>
                    <label><input type="checkbox" id="setAddPaid"> Add 'Paid' text on Invoices that have been
                        paid</label>
                    <label><input type="checkbox" id="setAddOverdue"> Add 'Overdue' text on Invoices that are
                        overdue</label>
                    <label><input type="checkbox" id="setFullHeight"> Invoice Items table uses full page height</label>
                    <label><input type="checkbox" id="setPrintQR"> Print Payment QR Code on Invoice</label>
                </div>

                <!-- Invoice Numbering -->
                <h4 style="color: #333; border-bottom: 1px solid #ccc; padding-bottom: 5px; margin: 20px 0 10px;">
                    Invoice Numbering</h4>
                <div class="settings-row"><label>Prefix (optional):</label><input type="text" id="setNumberPrefix"
                        placeholder="Enter Prefix"></div>
                <div class="settings-row"><label>Number:</label><input type="number" id="setStartNumber" value="10001">
                </div>

                <!-- Custom Fields -->
                <h4 style="color: #333; border-bottom: 1px solid #ccc; padding-bottom: 5px; margin: 20px 0 10px;">Custom
                    Fields</h4>
                <p style="font-size: 12px; color: #666; margin-bottom: 10px;">Add additional fields that you want to add
                    at the top or bottom of the invoice.</p>
                <div class="settings-row">
                    <label>Custom Field 1:</label>
                    <input type="text" id="customField1" style="flex: 2;">
                    <select id="customField1Pos" style="width: 80px; padding: 8px; border: 1px solid #ccc;">
                        <option>Top</option>
                        <option>Bottom</option>
                    </select>
                </div>
                <div class="settings-row">
                    <label>Custom Field 2:</label>
                    <input type="text" id="customField2" style="flex: 2;">
                    <select id="customField2Pos" style="width: 80px; padding: 8px; border: 1px solid #ccc;">
                        <option>Top</option>
                        <option>Bottom</option>
                    </select>
                </div>

                <!-- Comments -->
                <h4 style="color: #333; border-bottom: 1px solid #ccc; padding-bottom: 5px; margin: 20px 0 10px;">
                    Comments</h4>
                <div class="settings-row" style="align-items: flex-start;">
                    <label>Invoice public note / Bank details:</label>
                    <textarea id="setPublicNote" rows="2" placeholder="Enter Public Note"
                        style="flex: 1; padding: 8px; border: 1px solid #ccc;"></textarea>
                </div>
                <div class="settings-row">
                    <label>Alignment/Font size:</label>
                    <select style="padding: 8px; border: 1px solid #ccc;">
                        <option>Left</option>
                        <option>Center</option>
                        <option>Right</option>
                    </select>
                    <select style="padding: 8px; border: 1px solid #ccc;">
                        <option>Normal</option>
                        <option>Small</option>
                        <option>Large</option>
                    </select>
                </div>
                <div class="settings-row" style="align-items: flex-start;">
                    <label>Invoice foot note:</label>
                    <textarea id="setFootNote" rows="2" placeholder="Thank you for your business."
                        style="flex: 1; padding: 8px; border: 1px solid #ccc;"></textarea>
                </div>

                <!-- Late Fees -->
                <h4 style="color: #333; border-bottom: 1px solid #ccc; padding-bottom: 5px; margin: 20px 0 10px;">Late
                    Fees</h4>
                <div class="checkbox-group">
                    <label><input type="radio" name="lateFee" value="none" checked> None</label>
                    <label><input type="radio" name="lateFee" value="interest"> Interest Rate / month: <input
                            type="text" value="0.00%"
                            style="width: 60px; padding: 4px; border: 1px solid #ccc;"></label>
                    <label><input type="radio" name="lateFee" value="flat"> Flat Fee / month: <input type="text"
                            value="RM0.00" style="width: 80px; padding: 4px; border: 1px solid #ccc;"></label>
                </div>

                <!-- Grace Period -->
                <h4 style="color: #333; border-bottom: 1px solid #ccc; padding-bottom: 5px; margin: 20px 0 10px;">Grace
                    Period (Days)</h4>
                <div class="settings-row">
                    <input type="number" id="gracePeriod" value="14" style="width: 80px;">
                    <label><input type="checkbox" id="autoCalculate"> Auto-calculate</label>
                </div>

                <!-- Email Settings -->
                <h4 style="color: #333; border-bottom: 1px solid #ccc; padding-bottom: 5px; margin: 20px 0 10px;">Email
                    Settings</h4>
                <div class="settings-row"><label>Email From:</label><input type="text" id="emailFrom"
                        placeholder="%BusinessName% via Brisk Invoicing"></div>
                <div class="settings-row"><label>Email Subject:</label><input type="text" id="emailSubject"
                        placeholder="%BusinessName%'s %Brisk %DocumentType%"></div>
                <div class="settings-row" style="align-items: flex-start;">
                    <label>Default Email Message:</label>
                    <textarea id="defaultEmailMsg" rows="3" placeholder="Enter Default Email Message"
                        style="flex: 1; padding: 8px; border: 1px solid #ccc;"></textarea>
                </div>
                <div class="checkbox-group" style="margin-top: 10px;">
                    <label><input type="checkbox" id="autoBcc" checked> Auto BCC All Emails</label>
                </div>
                <div class="settings-row"><label>BCC Email Address:</label><input type="email" id="bccEmail"
                        placeholder="example@gmail.com"></div>

                <!-- Late Payment Reminder -->
                <h4 style="color: #333; border-bottom: 1px solid #ccc; padding-bottom: 5px; margin: 20px 0 10px;">Late
                    Payment Reminder</h4>
                <div class="checkbox-group">
                    <label><input type="checkbox" id="autoReminder"> Automatically send a reminder</label>
                </div>
                <div class="settings-row">
                    <label>Reminder Date:</label>
                    <input type="number" value="7" style="width: 60px;"> days
                    <select style="padding: 8px; border: 1px solid #ccc;">
                        <option>before the due date</option>
                        <option>after the due date</option>
                    </select>
                </div>
                <div class="settings-row"><label>Subject:</label><input type="text"
                        placeholder="Your invoice from %BusinessName% is due"></div>
                <div class="settings-row" style="align-items: flex-start;">
                    <label>Body:</label>
                    <textarea rows="4"
                        placeholder="Hello %CustomerName%,&#10;Please see the attached PDF invoice for your account.&#10;&#10;Thank you for your business.&#10;Best Regards, %BusinessName%"
                        style="flex: 1; padding: 8px; border: 1px solid #ccc;"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button id="saveInvoiceSettings" class="btn btn-primary" style="background: #449d44;">Save
                    Settings</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>

</html>